<!DOCTYPE html><html lang="ja"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, minimum-scale=1, initial-scale=1"><title>APIの利用方法</title><!--*
*
* GitHub: https://github.com/joinmisskey
*
*--><link rel="canonical" href="https://join.misskey.page/ja/wiki/developers/api"><link rel="alternate" hreflang="ja" href="https://join.misskey.page/ja/wiki/developers/api"><link rel="alternate" hreflang="en" href="https://join.misskey.page/en/wiki/developers/api"><link rel="alternate" hreflang="fr" href="https://join.misskey.page/fr/wiki/developers/api"><link rel="alternate" hreflang="de" href="https://join.misskey.page/de/wiki/developers/api"><meta name="author" content="Misskey"><meta name="generator" content="maqz"><meta name="robots" content="noindex,follow"><meta name="description" content="MisskeyのAPIの利用方法について簡単に解説する。"><link rel="manifest" href="/manifest.json"><link rel="alternate" type="application/atom+xml" title="joinmisskey" href="https://join.misskey.page/feed.atom"><link rel="alternate" type="application/rss+xml" title="joinmisskey" href="https://join.misskey.page/feed.rss"><link rel="alternate" type="application/json" title="joinmisskey" href="https://join.misskey.page/feed.json"><link rel="preload" href="https://cdn.jsdelivr.net/gh/tamaina/The-Japanese-Web-Fonts@v7.2.0/dist/mplus-c/mplus-c-light.latain.woff2" as="font" crossorigin><link rel="preload" href="https://cdn.jsdelivr.net/gh/tamaina/The-Japanese-Web-Fonts@v7.2.0/dist/mplus-p/mplus-p-regular.latain.woff2" as="font" crossorigin><link rel="preload" href="https://cdn.jsdelivr.net/gh/tamaina/The-Japanese-Web-Fonts@v7.2.0/dist/mplus-p/mplus-p-bold.latain.woff2" as="font" crossorigin><link rel="preload" href="/assets/styles/fonts.css" as="style"><link rel="preload" href="https://cdn.jsdelivr.net/npm/yakuhanjp@3.3.0/dist/css/yakuhanjp.min.css" as="style"><link rel="preload" href="https://cdn.jsdelivr.net/gh/tamaina/The-Japanese-Web-Fonts@v7.2.0/dist/NasuM/NasuM.css" as="style"><link rel="preload" href="/assets/styles/fonts-ja.css" as="style"><link rel="preload" href="https://cdn.jsdelivr.net/npm/animate.css@3.7.0/animate.min.css" as="style"><link rel="preload" href="https://twemoji.maxcdn.com/v/latest/twemoji.min.js" as="script"><script id="page_variables">var pathname = "/";
var currentLocale = "ja";
var locales = ["ja","en","fr","de"];
var permalink = "/wiki/developers/api";
var gaId = "UA-121612835-1";
var jm_pathToWorker = "https://join.misskey.page/service_worker.js"
</script><script src="/assets/scripts/sw.js" async></script><script src="/assets/scripts/bootstrap.js" async></script><script src="/assets/scripts/main.js" async></script><script src="https://www.googletagmanager.com/gtag/js?id=UA-121612835-1" async></script><link rel="stylesheet" href="/assets/styles/main.css"><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script>(adsbygoogle = window.adsbygoogle || []).push({
  google_ad_client: "ca-pub-1736621122676736",
  enable_page_level_ads: true,
  overlays: { bottom: true }
});
</script><link rel="icon" href="/favicon.ico" type="image/vnd.microsoft.icon"><link rel="apple-touch-icon" href="/files/images/imports/2020/03/icon-2.svg?v=undefined" sizes="192x192"><link rel="icon" href="/files/images/imports/2020/03/icon-2.svg?v=undefined" sizes="192x192" type="image/svg+xml"><link rel="apple-touch-icon" href="/files/images/imports/2020/03/icon-2-maskable.svg?v=undefined" sizes="192x192"><link rel="icon" href="/files/images/imports/2020/03/icon-2-maskable.svg?v=undefined" sizes="192x192" type="image/svg+xml"><link rel="apple-touch-icon" href="/files/images/imports/2020/03/icon-2.svg?v=undefined" sizes="1200x1200"><link rel="icon" href="/files/images/imports/2020/03/icon-2.svg?v=undefined" sizes="1200x1200" type="image/svg+xml"><link rel="apple-touch-icon" href="/files/images/imports/2020/03/icon-2-maskable.svg?v=undefined" sizes="1200x1200"><link rel="icon" href="/files/images/imports/2020/03/icon-2-maskable.svg?v=undefined" sizes="1200x1200" type="image/svg+xml"><link rel="apple-touch-icon" href="/files/images/imports/2020/03/icon-2-maskable.360.png?v=undefined" sizes="360x360"><link rel="icon" href="/files/images/imports/2020/03/icon-2-maskable.360.png?v=undefined" sizes="360x360" type="image/png"><link rel="apple-touch-icon" href="/files/images/imports/2020/03/icon-2-maskable.720.png?v=undefined" sizes="720x720"><link rel="icon" href="/files/images/imports/2020/03/icon-2-maskable.720.png?v=undefined" sizes="720x720" type="image/png"><link rel="apple-touch-icon" href="/files/images/imports/2020/03/icon-2-maskable.png?v=undefined" sizes="1200x1200"><link rel="icon" href="/files/images/imports/2020/03/icon-2-maskable.png?v=undefined" sizes="1200x1200" type="image/png"><meta name="theme-color" content="#86b300"><meta property="og:type" content="website"><meta property="og:title" content="APIの利用方法"><meta property="og:description" content="MisskeyのAPIの利用方法について簡単に解説する。"><meta property="og:image" content="https://join.misskey.page/files/images/imports/2019/10/thumb.png?v=undefined"><meta property="og:url" content="https://join.misskey.page/ja/wiki/developers/api"><meta property="og:site_name" content="Misskeyをはじめよう"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://join.misskey.page/files/images/imports/2019/10/thumb.png?v=undefined"><meta name="twitter:title" content="APIの利用方法"><meta name="twitter:description" content="MisskeyのAPIの利用方法について簡単に解説する。"><meta name="twitter:site" content="misskey_io"></head><body><div id="nav"><nav class="navbar navbar-expand-md navbar-light flex-row p-0" id="mainnav"><button class="navbar-toggler" data-toggle="collapse" data-target="#navtoggle" aria-controls="navtoggle" aria-expanded="false" aria-label="Toggle navigation"><i class="fa fas bars" data-fa-prefix="fas" data-fa-icon-name="bars" data-fa-option="{}"></i></button><div class="collapse navbar-collapse" id="navtoggle"><ul class="navbar-nav mr-auto mt-lg-0 ml-3 ml-md-0"><li class="nav-item px-md-3"><a class="nav-link" href="/ja/"><i class="fa fas home" data-fa-prefix="fas" data-fa-icon-name="home" data-fa-option="{'classes':['fa-fw']}"></i><span class="d-inline d-md-none d-lg-inline">&ensp;ホーム</span></a></li><li class="nav-item px-md-3"><a class="nav-link" href="/ja/wiki/instances/"><i class="fa fas server" data-fa-prefix="fas" data-fa-icon-name="server" data-fa-option="{'classes':['fa-fw']}"></i><span class="d-inline d-md-none d-lg-inline">&ensp;インスタンス</span></a></li><li class="nav-item px-md-3"><a class="nav-link" href="/ja/blog/"><i class="fa fas broadcast-tower" data-fa-prefix="fas" data-fa-icon-name="broadcast-tower" data-fa-option="{'classes':['fa-fw']}"></i><span class="d-inline d-md-none d-lg-inline">&ensp;ブログ</span></a></li><li class="nav-item px-md-3 active"><a class="nav-link" href="/ja/wiki/"><i class="fa fas book" data-fa-prefix="fas" data-fa-icon-name="book" data-fa-option="{'classes':['fa-fw']}"></i><span class="d-inline d-md-none d-lg-inline">&ensp;Wiki</span></a></li></ul><div class="input-group flex-nowrap" id="search"><input class="form-control" id="searchInput" type="search" placeholder="検索語句を入力" aria-label="検索"><div class="input-group-append flex-grow-0 flex-shrink-0"><button class="btn btn-primary" id="searchButton"><i class="fa fas search" data-fa-prefix="fas" data-fa-icon-name="search" data-fa-option="{'classes':['fa-fw']}"></i> 検索</button></div></div></div><div class="dropleft"><button class="btn btn-outline-primary dropdown-toggle" type="button" id="locale_dropdown" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">A文</button><div class="dropdown-menu m-2" aria-labelledby="locale_dropdown"><button class="nihongo dropdown-item" data-lang="ja">日本語</button><button class="nihongo dropdown-item" data-lang="en">English</button><button class="nihongo dropdown-item" data-lang="fr">Français</button><button class="nihongo dropdown-item" data-lang="de">Deutsch</button></div></div></nav><nav class="bg-transparent" aria-label="breadcrumb" id="breadcrumb"><div class="container-fulid px-1 px-lg-5"><ol class="breadcrumb bg-transparent text-primary my-0 mx-md-5 mx-1 py-1 px-0" vocab="https://schema.org/" typeof="BreadcrumbList"><li class="breadcrumb-item" property="itemListElement" typeof="ListItem"><a class="text-primary" href="/ja/" property="item" typeof="WebPage"><i class="fa fas home" data-fa-prefix="fas" data-fa-icon-name="home" data-fa-option="{'classes':['fa-fw']}"></i><span class="sr-only" property="name">Misskeyをはじめよう</span></a><meta property="position" content="1"></li><li class="breadcrumb-item" property="itemListElement" typeof="ListItem"><a class="text-primary" href="/ja/wiki/" property="item" typeof="WebPage"><span property="name">Wiki</span></a><meta property="position" content="2"></li><li class="breadcrumb-item" property="itemListElement" typeof="ListItem"><a class="text-primary" href="/ja/wiki/developers/" property="item" typeof="WebPage"><span property="name">開発者・運営者向け情報</span></a><meta property="position" content="3"></li><li class="breadcrumb-item active" property="itemListElement" typeof="ListItem"><a class="text-dark font-weight-bold trigger-gototop button-like-anchor" aria-current="page" href="https://join.misskey.page/ja/wiki/developers/api" property="item" typeof="WebPage"><span property="name">APIの利用方法</span></a><meta property="position" content="4"></li></ol></div></nav></div><div class="padding row" id="main"><div class="sade-outer d-none d-xl-block col-xl-3 order-1"><ins class="adsbygoogle p-0 sade d-none d-xl-block" style="display:block;" data-ad-client="ca-pub-1736621122676736" data-ad-slot="2773092095" data-ad-format="vertical" data-full-width-responsive="false"></ins></div><div class="p-0 col-12 px-xl-3 col-xl-9 order-0"><div class="container pt-5 pb-3 mb-2 bg-white main-shadow"><article class="bg-white" id="article_maincontent"><header class="w-100"><h1>APIの利用方法</h1></header><div class="my-2 p-3 bg-light" id="article_sidenav"><details><summary class="font-weight-bold">目次</summary><ul class="list-unstyled ml-3 page-index m-0 p-0"><li><a href="#i%E3%82%92%E5%8F%96%E5%BE%97%E3%81%99%E3%82%8B">iを取得する</a></li><ul class="list-unstyled ml-3 page-index"><li><a href="#%E8%87%AA%E5%88%86%E3%81%AE%E3%82%A2%E3%82%AB%E3%82%A6%E3%83%B3%E3%83%88%E3%81%AEi%E3%82%92%E5%8F%96%E5%BE%97%E3%81%99%E3%82%8B">自分のアカウントのiを取得する</a></li><li><a href="#MiAuth%E3%81%A7i%E3%82%92%E5%8F%96%E5%BE%97%E3%81%99%E3%82%8B">MiAuthでiを取得する</a></li><ul class="list-unstyled ml-3 page-index"><li><a href="#1%3A%20%E3%82%BB%E3%83%83%E3%82%B7%E3%83%A7%E3%83%B3ID%E3%81%AE%E7%94%9F%E6%88%90">1: セッションIDの生成</a></li><li><a href="#2%3A%20%E3%83%A6%E3%83%BC%E3%82%B6%E3%83%BC%E3%82%92%2Fmiauth%2F%3AsessionId%E3%81%AB%E3%82%A2%E3%82%AF%E3%82%BB%E3%82%B9%E3%81%95%E3%81%9B%E3%82%8B">2: ユーザーを<code class="language-javascript"><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">miauth</span><span class="token regex-delimiter">/</span></span><span class="token operator">:</span>sessionId</code>にアクセスさせる</a></li><li><a href="#3%3A%20%E3%82%A2%E3%82%AF%E3%82%BB%E3%82%B9%E3%83%88%E3%83%BC%E3%82%AF%E3%83%B3%E3%82%92%E5%8F%96%E5%BE%97">3: アクセストークンを取得</a></li></ul></ul><li><a href="#%E6%A7%98%E3%80%85%E3%81%AA%E3%82%A8%E3%83%B3%E3%83%89%E3%83%9D%E3%82%A4%E3%83%B3%E3%83%88%E3%82%92%E5%88%A9%E7%94%A8%E3%81%99%E3%82%8B">様々なエンドポイントを利用する</a></li><li><a href="#%E3%83%A9%E3%83%83%E3%83%91%E3%83%BC%E3%83%A9%E3%82%A4%E3%83%96%E3%83%A9%E3%83%AA%E3%82%92%E5%88%A9%E7%94%A8%E3%81%99%E3%82%8B">ラッパーライブラリを利用する</a></li><li><a href="#%E3%82%B5%E3%83%BC%E3%83%93%E3%82%B9%E3%81%ABMisskey%E3%82%A2%E3%82%AB%E3%82%A6%E3%83%B3%E3%83%88%E3%81%A7%E3%83%AD%E3%82%B0%E3%82%A4%E3%83%B3%E3%81%A7%E3%81%8D%E3%82%8B%E3%82%88%E3%81%86%E3%81%AB%E3%81%99%E3%82%8B%E3%81%AB%E3%81%AF%EF%BC%9F">サービスにMisskeyアカウントでログインできるようにするには？</a></li><ul class="list-unstyled ml-3 page-index"><li><a href="#notestock%E3%81%AEActivityPub%E7%B5%8C%E7%94%B1%E3%81%AE%E3%82%A2%E3%82%AB%E3%82%A6%E3%83%B3%E3%83%88%E7%A2%BA%E8%AA%8D%E3%81%AE%E6%89%8B%E9%A0%86">notestockのActivityPub経由のアカウント確認の手順</a></li></ul></details></div><section class="pt-2 pb-4"><p>ここでは、Node.js上で<a href="https://github.com/axios/axios" target="_blank" rel="noopener">HTTPクライアント「axios」<i class="fa fas external-link-alt" data-fa-prefix="fas" data-fa-icon-name="external-link-alt" data-fa-option="{'classes':['fa-fw', 'fa-sm']}"></i></a>を使用し、APIを操作してみる。</p><p>ここで提示するコードは<a href="https://npm.runkit.com/axios" target="_blank" rel="noopener">RunKit<i class="fa fas external-link-alt" data-fa-prefix="fas" data-fa-icon-name="external-link-alt" data-fa-option="{'classes':['fa-fw', 'fa-sm']}"></i></a>で実際に実行できる。</p><p><small>公式ドキュメント: <a href="https://github.com/syuilo/misskey/blob/develop/src/docs/api.ja-JP.md" target="_blank" rel="noopener">https://github.com/syuilo/misskey/blob/develop/src/docs/api.ja-JP.md</a></small></p><ins class="adsbygoogle my-5" style="display:block; text-align:left;" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-1736621122676736" data-ad-slot="9247410221"></ins><h2 id="i%E3%82%92%E5%8F%96%E5%BE%97%E3%81%99%E3%82%8B" class="blogstyle">iを取得する</h2><p>MisskeyのAPIでは、APIキーとも呼ばれるキーを<code class="language-javascript">i</code>として本文に含めることでAPIを利用できる。<br>様々な場面で<code class="language-javascript">i</code>という名前で扱われるため、ここではこのAPIキーを単に<code class="language-javascript">i</code>と呼ぶことにする。</p><h3 id="%E8%87%AA%E5%88%86%E3%81%AE%E3%82%A2%E3%82%AB%E3%82%A6%E3%83%B3%E3%83%88%E3%81%AEi%E3%82%92%E5%8F%96%E5%BE%97%E3%81%99%E3%82%8B" class="blogstyle">自分のアカウントのiを取得する</h3><p>自分のアカウントのiはアカウント設定（<code class="language-javascript"><span class="token operator">/</span>my<span class="token operator">/</span>settings</code>）のAPI欄のトークンに表示されている。</p><p>ここで取得できるiは特別なiで、アカウントの全ての情報を操作できるため、インターネット上に公開したり第三者に教えたりしてはいけない。</p><p>まずはこのiを使って実際にAPIから投稿してみよう。<br>次のコードを、<code class="language-javascript"><span class="token number">1248</span>aBCDeFGH1632</code>を自分の<code class="language-javascript">i</code>に書き換えて実行してみよう。自分が登録しているインスタンスがmisskey.ioでない場合は自分のインスタンスのURLに置き換えて実行しよう。</p><pre class="language-javascript"><code class="language-javascript">axios<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">"https://misskey.io/api/notes/create"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>i<span class="token operator">:</span> <span class="token string">"1248aBCDeFGH1632"</span><span class="token punctuation">,</span> text<span class="token operator">:</span> <span class="token string">"Hello Misskey API World!"</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span>data<span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre><p>自分のアカウントから「Hello Misskey API World!」という文章が投稿されたはずだ。</p><h3 id="MiAuth%E3%81%A7i%E3%82%92%E5%8F%96%E5%BE%97%E3%81%99%E3%82%8B" class="blogstyle">MiAuthでiを取得する</h3><p><strong>上の方法で取得したiはアカウントの全ての情報を操作できるため、アプリケーションで使用するのは大変危険である。</strong><br>WebViewのストレージからiを取得する等の実装は、絶対にしないこと。</p><p>アプリケーションからAPIを利用する際には、アプリケーションとユーザーが結び付けられた専用のアクセストークンを発行する。</p><p>12.27.0以降で利用できる方式はMiAuthと呼ばれ、今後はこの方式を使うことが推奨される。<br>MiAuthに対応しているかどうかは<code class="language-javascript">api<span class="token operator">/</span>meta</code>の<code class="language-javascript">features<span class="token punctuation">.</span>miauth</code>が存在するかどうかで判定できる。<br><a href="old-api">12.27.0未満のバージョンのアクセストークン取得方法はこちら</a></p><p><strong>なお、OAuthでの認証はMisskeyに実装されていない。</strong></p><h4 id="1%3A%20%E3%82%BB%E3%83%83%E3%82%B7%E3%83%A7%E3%83%B3ID%E3%81%AE%E7%94%9F%E6%88%90" class="blogstyle">1: セッションIDの生成</h4><p>UUIDを生成する。 以後これをセッションIDと呼ぶ。</p><p>このセッションIDは毎回生成し、使いまわさないように。</p><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> <span class="token punctuation">{</span> v4 <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"uuid"</span><span class="token punctuation">)</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">v4</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">// ここでは 19bbf45d-5ae7-4c87-b33e-2933b3eec683 が生成されたものとして進める。</span>
<span class="token comment">// 実際のインスタンスで試すときは絶対に他のuuidを使うこと。  </span>
</code></pre><p>リンク: <a href="https://www.wellhat.co.jp/tools/uuid.html" target="_blank" rel="noopener">UUID生成ツール<i class="fa fas external-link-alt" data-fa-prefix="fas" data-fa-icon-name="external-link-alt" data-fa-option="{'classes':['fa-fw', 'fa-sm']}"></i></a></p><ins class="adsbygoogle my-5" style="display:block; text-align:left;" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-1736621122676736" data-ad-slot="9247410221"></ins><h4 id="2%3A%20%E3%83%A6%E3%83%BC%E3%82%B6%E3%83%BC%E3%82%92%2Fmiauth%2F%3AsessionId%E3%81%AB%E3%82%A2%E3%82%AF%E3%82%BB%E3%82%B9%E3%81%95%E3%81%9B%E3%82%8B" class="blogstyle">2: ユーザーを<code class="language-javascript"><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">miauth</span><span class="token regex-delimiter">/</span></span><span class="token operator">:</span>sessionId</code>にアクセスさせる</h4><p><code class="language-javascript"><span class="token operator">/</span>miauth<span class="token operator">/</span><span class="token number">19</span>bbf45d<span class="token operator">-</span><span class="token number">5</span>ae7<span class="token operator">-</span><span class="token number">4</span>c87<span class="token operator">-</span>b33e<span class="token operator">-</span><span class="token number">2933</span>b3eec683</code>（<code class="language-javascript"><span class="token number">19</span>bbf<span class="token operator">...</span></code>は生成したセッションIDに置き換える）をユーザーにブラウザでアクセスさせる。</p><p>表示する際、URLにクエリパラメータとしていくつかのオプションを設定できる:</p><ul><li><code class="language-javascript">name</code>: アプリケーション名<ul><li>例: <code class="language-javascript">MissDeck</code></li></ul></li><li><code class="language-javascript">icon</code>: アプリケーションのアイコン画像URL<ul><li>例: <code class="language-javascript">https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>missdeck<span class="token punctuation">.</span>example<span class="token punctuation">.</span>com<span class="token operator">/</span>icon<span class="token punctuation">.</span>png</code></li></ul></li><li><code class="language-javascript">callback</code>: 認証が終わった後にリダイレクトするURL<ul><li>例: <code class="language-javascript">https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>missdeck<span class="token punctuation">.</span>example<span class="token punctuation">.</span>com<span class="token operator">/</span>callback</code></li><li><code class="language-javascript">https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>missdeck<span class="token punctuation">.</span>example<span class="token punctuation">.</span>com<span class="token operator">/</span>callback<span class="token operator">?</span>session<span class="token operator">=</span><span class="token number">19</span>bbf45d<span class="token operator">-</span><span class="token number">5</span>ae7<span class="token operator">-</span><span class="token number">4</span>c87<span class="token operator">-</span>b33e<span class="token operator">-</span><span class="token number">2933</span>b3eec683</code>というように、クエリパラメータで<code class="language-javascript">session</code>にセッションIDが設定されてリダイレクトされる。</li></ul></li><li><code class="language-javascript">permission</code> ... アプリケーションが要求する権限<ul><li>例: <code class="language-javascript">write<span class="token operator">:</span>notes<span class="token punctuation">,</span>write<span class="token operator">:</span>following<span class="token punctuation">,</span>read<span class="token operator">:</span>drive</code></li><li>要求する権限を<code class="language-javascript"><span class="token punctuation">,</span></code>で区切って列挙する。</li><li>どのような権限があるかは各インスタンスのAPIリファレンス(/api-doc)で確認できる。</li></ul></li></ul><p>例:<br>インスタンス<code class="language-javascript">misskey<span class="token punctuation">.</span>example<span class="token punctuation">.</span>com</code>で認証させるとき、以下のURLにユーザーを誘導すればよい。</p><pre class="language-javascript"><code class="language-javascript">https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>misskey<span class="token punctuation">.</span>example<span class="token punctuation">.</span>com<span class="token operator">/</span>miauth<span class="token operator">/</span><span class="token number">19</span>bbf45d<span class="token operator">-</span><span class="token number">5</span>ae7<span class="token operator">-</span><span class="token number">4</span>c87<span class="token operator">-</span>b33e<span class="token operator">-</span><span class="token number">2933</span>b3eec683<span class="token operator">?</span>name<span class="token operator">=</span>MissDeck<span class="token operator">&amp;</span>icon<span class="token operator">=</span>https<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">2</span>F<span class="token operator">%</span><span class="token number">2</span>Fmissdeck<span class="token punctuation">.</span>example<span class="token punctuation">.</span>com<span class="token operator">%</span><span class="token number">2</span>Ficon<span class="token punctuation">.</span>png<span class="token operator">&amp;</span>callback<span class="token operator">=</span>https<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">2</span>F<span class="token operator">%</span><span class="token number">2</span>Fmissdeck<span class="token punctuation">.</span>example<span class="token punctuation">.</span>com<span class="token operator">%</span><span class="token number">2</span>Fcallback<span class="token operator">&amp;</span>permission<span class="token operator">=</span>write<span class="token operator">%</span><span class="token number">3</span>Anotes<span class="token punctuation">,</span>write<span class="token operator">%</span><span class="token number">3</span>Afollowing<span class="token punctuation">,</span>read<span class="token operator">%</span><span class="token number">3</span>Adrive
</code></pre><h4 id="3%3A%20%E3%82%A2%E3%82%AF%E3%82%BB%E3%82%B9%E3%83%88%E3%83%BC%E3%82%AF%E3%83%B3%E3%82%92%E5%8F%96%E5%BE%97" class="blogstyle">3: アクセストークンを取得</h4><p>ユーザーが連携を許可した後、<code class="language-javascript"><span class="token operator">/</span>api<span class="token operator">/</span>miauth<span class="token operator">/</span><span class="token number">19</span>bbf45d<span class="token operator">-</span><span class="token number">5</span>ae7<span class="token operator">-</span><span class="token number">4</span>c87<span class="token operator">-</span>b33e<span class="token operator">-</span><span class="token number">2933</span>b3eec683<span class="token operator">/</span>check</code>（<code class="language-javascript"><span class="token number">19</span>bbf<span class="token operator">...</span></code>は自分のセッションIDに置き換える）に<strong>POST</strong>すると、レスポンスとしてアクセストークンを含むJSONが返る。</p><p>レスポンスに含まれるプロパティ:</p><ul><li><code class="language-javascript">token</code>: i（アクセストークン）</li><li><code class="language-javascript">user</code>: ユーザーの情報</li></ul><pre class="language-javascript"><code class="language-javascript">axios<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">"https://misskey.example.com/api/miauth/19bbf45d-5ae7-4c87-b33e-2933b3eec683/check"</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span>token<span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre><h2 id="%E6%A7%98%E3%80%85%E3%81%AA%E3%82%A8%E3%83%B3%E3%83%89%E3%83%9D%E3%82%A4%E3%83%B3%E3%83%88%E3%82%92%E5%88%A9%E7%94%A8%E3%81%99%E3%82%8B" class="blogstyle">様々なエンドポイントを利用する</h2><p>各インスタンスの<code class="language-javascript"><span class="token operator">/</span>api<span class="token operator">-</span>doc</code>（例: <a href="https://misskey.io/api-doc" target="_blank" rel="noopener">https://misskey.io/api-doc</a> ）にアクセスすることで、そのインスタンスで利用できるAPIの一覧と必要なパーミッションを見ることができる。</p><h2 id="%E3%83%A9%E3%83%83%E3%83%91%E3%83%BC%E3%83%A9%E3%82%A4%E3%83%96%E3%83%A9%E3%83%AA%E3%82%92%E5%88%A9%E7%94%A8%E3%81%99%E3%82%8B" class="blogstyle">ラッパーライブラリを利用する</h2><p>有志の方々がAPIをより簡単に利用できるようにするラッパーライブラリを各言語・実行環境向けに開発している。<br><strong><a href="../apps/libraries">ライブラリ</a></strong></p><h2 id="%E3%82%B5%E3%83%BC%E3%83%93%E3%82%B9%E3%81%ABMisskey%E3%82%A2%E3%82%AB%E3%82%A6%E3%83%B3%E3%83%88%E3%81%A7%E3%83%AD%E3%82%B0%E3%82%A4%E3%83%B3%E3%81%A7%E3%81%8D%E3%82%8B%E3%82%88%E3%81%86%E3%81%AB%E3%81%99%E3%82%8B%E3%81%AB%E3%81%AF%EF%BC%9F" class="blogstyle">サービスにMisskeyアカウントでログインできるようにするには？</h2><p>MiAuthでは、アプリという概念がないため、「サービスにMisskeyアカウントでログインする」という実装では使い捨てのアクセストークンを発行することになる。<br>すると、ユーザーの「インストールされたアプリ」に同一のアプリがインストールされるたびに増えていくことになってしまう。</p><p><a href="old-api">旧来のアプリ型認証</a>を利用するという手段もあるが、この方式は将来的に廃止されるかもしれない。</p><p>そこで、joinmisskeyとしては、<strong>ActivityPub経由のアカウント確認</strong>をお勧めしたい。<br>ActivityPubで実装することで、MisskeyだけでなくPleromaやMastodonでもアカウント確認が行えるため、より多くのユーザーの認証に対応できることになる。</p><p>例として、<a href="https://notestock.osa-p.net/" target="_blank" rel="noopener">notestock<i class="fa fas external-link-alt" data-fa-prefix="fas" data-fa-icon-name="external-link-alt" data-fa-option="{'classes':['fa-fw', 'fa-sm']}"></i></a>はActivityPub経由のアカウント確認を実装している。</p><h3 id="notestock%E3%81%AEActivityPub%E7%B5%8C%E7%94%B1%E3%81%AE%E3%82%A2%E3%82%AB%E3%82%A6%E3%83%B3%E3%83%88%E7%A2%BA%E8%AA%8D%E3%81%AE%E6%89%8B%E9%A0%86" class="blogstyle">notestockのActivityPub経由のアカウント確認の手順</h3><ol><li>ユーザーに（@<a href="mailto:username@instance.domain">username@instance.domain</a>のような）ユーザーネームを入力させ、サーバーに記録する。</li><li>1.を受け取ったサーバーは乱数を生成し、フロントエンドに伝える。</li><li>ユーザーに、サービスの代表Actorに向けて乱数をメンションさせる。<br>Misskeyでは、<code class="language-javascript"><span class="token operator">/</span>share<span class="token operator">?</span>text<span class="token operator">=</span>（<span class="token constant">URL</span>エンコードされた任意の文章）</code>というようなURLにアクセスすると任意の文章が入力された投稿フォームを開くことができるため、このリンクを用意すると良いだろう。</li><li>ユーザーからのメンションを受け取ったら、1で入力させたユーザーネーム及び乱数が合致しているを確認する。これでユーザーの確認はとれた。</li><li>サービスのアクセストークンなどを発行し、4.が終わったことをフロントエンドに伝える。<br>フロントエンドがユーザーの確認を待つときに、notestockはポーリングで実装しているようだが、Server-Sent Eventsで実装するのもよいだろう。</li></ol></section><footer class="w-100"><div class="d-flex flex-wrap my-2 bg-light"><a class="p-3 flex-fill" href="/ja/wiki/developers/websocket" id="next"><div class="container">次: ストリーミングAPIの利用方法</div></a></div></footer></article><div class="small text-right mt-3"><a href="https://github.com/joinmisskey/joinmisskey.github.io/edit/pages/ja/wiki/developers/api.md" target="_blank" rel="noopener"><i class="fa fas pencil-alt" data-fa-prefix="fas" data-fa-icon-name="pencil-alt" data-fa-option="{'classes':['fa-fw']}"></i>このページを編集</a></div></div></div><div class="py-3 col-12 px-0 w-100 order-2 text-center"><ins class="adsbygoogle container p-0" style="display:block;" data-ad-client="ca-pub-1736621122676736" data-ad-slot="4446014841" data-ad-format="auto" data-full-width-responsive="false"></ins></div></div><div class="bg-white mt-2" id="footer"><div class="py-3" id="footer_wrap"><div class="container"><div class="d-flex justify-content-between flex-wrap small"><div>© 2018-2021 Misskey</div><!--.
.
.
--><div class="text-muted" id="updateTime">2021年3月24日 12:02 JST 更新</div><!--.
.
.
--><div><a href="https://github.com/syuilo/misskey" target="_blank" rel="noopener"><i class="fa fab github" data-fa-prefix="fab" data-fa-icon-name="github" data-fa-option="{'classes':['fa-fw']}"></i><span class="sr-only">GitHub</span>Misskey</a> <a href="https://github.com/joinmisskey/joinmisskey.github.io" target="_blank" rel="noopener"><i class="fa fab github" data-fa-prefix="fab" data-fa-icon-name="github" data-fa-option="{'classes':['fa-fw']}"></i><span class="sr-only">GitHub</span>joinmisskey</a> <a href="https://misskey.io/@joinmisskey" target="_blank" rel="noopener"><svg aria-hidden="true" focusable="false" role="img" class="svg-inline--fa fa-w-16 fa-fw" version="1.1" viewBox="0 0 225.24 256.53" xmlns="http://www.w3.org/2000/svg"><path d="m112.63 0c-4.0923 0-7.873 2.183-9.9199 5.7266-5.7762 10.005-12.904 22.35-18.006 31.187-4.1125 7.1231-4.1125 15.896 0 23.02 5.0963 8.8286 12.217 21.157 17.99 31.158 2.0498 3.5493 5.836 5.7363 9.9355 5.7363s7.8877-2.187 9.9375-5.7363c5.7734-10.001 12.891-22.328 17.988-31.158 4.1125-7.1216 4.1125-15.896 0-23.02-5.1021-8.8372-12.228-21.182-18.006-31.187-2.0454-3.5435-5.8276-5.7266-9.9199-5.7266zm0 8.6426c1.0054 0 1.9328 0.53621 2.4356 1.4062l18.006 31.186c2.5683 4.4481 2.5683 9.9288 0 14.377-5.0978 8.83-12.215 21.157-17.99 31.158-0.5056 0.8758-1.44 1.416-2.4512 1.416s-1.9456-0.54022-2.4512-1.416c-5.7734-10.001-12.891-22.328-17.988-31.156-2.5683-4.4496-2.5683-9.9308 0-14.379 5.1021-8.8372 12.228-21.18 18.004-31.186 0.50272-0.87004 1.4315-1.4062 2.4355-1.4062zm101.13 49.76c-11.553 3.46e-4 -25.805 0.001897-36.01 0.001953-8.225-2e-6 -15.823 4.3867-19.936 11.51-5.0976 8.8278-12.216 21.156-17.99 31.156-2.0489 3.5498-2.0498 7.9243 0 11.475 2.0498 3.5503 5.8388 5.7378 9.9375 5.7383 11.548-6.8e-4 25.783-0.00176 35.979-0.00195 8.2238 7.2e-4 15.823-4.3867 19.936-11.51 5.1022-8.8371 12.23-21.179 18.006-31.186 2.0461-3.5432 2.0462-7.911 0-11.455-2.0462-3.5441-5.8296-5.7276-9.9219-5.7285zm-202.27 0.02539c-4.0915-3.53e-4 -7.8738 2.1844-9.9199 5.7285-2.0462 3.5441-2.0453 7.9107 0 11.455 5.7768 10.005 12.904 22.348 18.006 31.186 4.1125 7.123 11.712 11.51 19.938 11.51 10.194 7.3e-4 24.429-6.7e-4 35.977 0 4.0987-5e-4 7.8877-2.186 9.9375-5.7363 2.0498-3.5503 2.0489-7.9248 0-11.475-5.7745-10-12.892-22.328-17.99-31.158-4.1112-7.1223-11.711-11.51-19.936-11.51-10.204-5.7e-5 -24.458-9.03e-4 -36.012 0zm27.98 79.814c-8.225-1e-5 -15.825 4.3887-19.938 11.512-5.0976 8.8278-12.214 21.156-17.988 31.156-2.0489 3.5498-2.0498 7.9224 0 11.473 2.0498 3.5503 5.8388 5.7378 9.9375 5.7383 11.548-6.8e-4 25.783 1.9e-4 35.979 0 8.2238 7.2e-4 15.823-4.3867 19.936-11.51 5.1022-8.8371 12.228-21.181 18.004-31.188 2.0461-3.5432 2.0462-7.911 0-11.455-2.0462-3.5441-5.8277-5.7257-9.9199-5.7266-11.553 3.4e-4 -25.805-6e-5 -36.01 0zm110.3 0.02343c-4.0915-3.4e-4 -7.8738 2.1844-9.9199 5.7285s-2.0473 7.9107-0.00196 11.455c5.7768 10.005 12.904 22.348 18.006 31.186 4.1125 7.1231 11.712 11.51 19.938 11.51 10.194 7.3e-4 24.429-6.7e-4 35.977 0 4.0986-5e-4 7.8877-2.186 9.9375-5.7363 2.0498-3.5503 2.0489-7.9248 0-11.475-5.7745-10-12.892-22.328-17.99-31.158-4.1112-7.1223-11.711-11.51-19.936-11.51-10.204-5e-5 -24.456-8.9e-4 -36.01 0zm-110.3 8.6192c10.204-6e-5 24.457 3.4e-4 36.01 0 1.0048 3.5e-4 1.9335 0.53676 2.4355 1.4062 0.50272 0.87074 0.50211 1.9421 0 2.8125l-18.004 31.186c-2.568 4.4483-7.3148 7.1896-12.451 7.1895-10.196 2e-4 -24.43-0.00139-35.979-0.00196-1.0113 4e-5 -1.9475-0.53833-2.4531-1.4141-0.5056-0.87572-0.50566-1.9563 0-2.832 5.7745-10 12.891-22.327 17.988-31.156 2.5693-4.449 7.3168-7.1896 12.453-7.1894zm110.3 0.02343h36.01c5.1364-1.8e-4 9.8832 2.7412 12.451 7.1895 5.0981 8.8298 12.216 21.157 17.99 31.158 0.50566 0.87576 0.5056 1.9544 0 2.8301-0.5056 0.87573-1.4419 1.416-2.4531 1.416-11.548-6.7e-4 -25.782-5.2e-4 -35.977 0-5.1376-5.4e-4 -9.8851-2.7411-12.453-7.1894-5.1022-8.8372-12.227-21.18-18.004-31.186-0.50211-0.87039-0.502-1.943 0-2.8125 0.50271-0.87073 1.4307-1.4059 2.4356-1.4062zm-37.154 12.793c-4.0923 0-7.875 2.183-9.9219 5.7266-5.7762 10.005-12.902 22.35-18.004 31.188-4.1125 7.1231-4.1125 15.896 0 23.02 5.0963 8.8286 12.215 21.157 17.988 31.158 2.0498 3.5493 5.838 5.7363 9.9375 5.7363s7.8877-2.187 9.9375-5.7363c5.7734-10.001 12.891-22.328 17.988-31.158 4.1125-7.1216 4.1125-15.896 0-23.02-5.1021-8.8372-12.228-21.182-18.006-31.188-2.0454-3.5435-5.8276-5.7266-9.9199-5.7266z" fill="currentColor"/></svg><span class="sr-only">Misskey</span></a> <a href="/feed.rss" target="_blank" rel="noopener"><i class="fa fas rss" data-fa-prefix="fas" data-fa-icon-name="rss" data-fa-option="{'classes':['fa-fw']}"></i><span>RSS</span></a> <a href="/feed.json" target="_blank" rel="noopener"><i class="fa fas rss" data-fa-prefix="fas" data-fa-icon-name="rss" data-fa-option="{'classes':['fa-fw']}"></i><span>JSON</span></a> <a href="/feed.atom" target="_blank" rel="noopener"><i class="fa fas rss" data-fa-prefix="fas" data-fa-icon-name="rss" data-fa-option="{'classes':['fa-fw']}"></i><span>Atom</span></a></div></div></div></div></div></body></html>